<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Order Confirmed ‚Äì Skyline Treats</title>
  <link rel="stylesheet" href="main.css" />
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=DM+Sans:wght@400;500;600&display=swap" rel="stylesheet" />
  <script>
    (function() {
      const t = localStorage.getItem('st_theme') || 'light';
      document.documentElement.setAttribute('data-theme', t);
    })();
    window.API_BASE = "http://localhost:8000/api";
  </script>
  <style>
    .ty-page { min-height: 100vh; background: var(--bg); padding-top: 64px; display: flex; flex-direction: column; align-items: center; }
    .ty-hero { background: var(--dark); width: 100%; padding: 72px 24px 64px; text-align: center; position: relative; overflow: hidden; }
    .ty-hero::before { content: ''; position: absolute; top: 50%; left: 50%; transform: translate(-50%,-50%); width: 600px; height: 400px; background: radial-gradient(ellipse, rgba(245,197,24,.15) 0%, transparent 70%); pointer-events: none; }
    .checkmark-circle { width: 80px; height: 80px; background: var(--accent); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 24px; font-size: 2.2rem; position: relative; animation: popIn .6s cubic-bezier(.175,.885,.32,1.275) both; }
    @keyframes popIn { from { opacity:0; transform:scale(.3); } to { opacity:1; transform:scale(1); } }
    @keyframes fadeUp { from { opacity:0; transform:translateY(20px); } to { opacity:1; transform:translateY(0); } }
    .ty-hero h1 { font-family: 'Playfair Display', serif; font-size: clamp(2rem,4vw,3rem); color: #fff; margin: 0 0 12px; position: relative; animation: fadeUp .5s .2s ease both; }
    .ty-hero p  { color: #999; font-size: 1rem; position: relative; animation: fadeUp .5s .35s ease both; max-width: 480px; margin: 0 auto; }
    .order-badge { display: inline-flex; align-items: center; gap: 10px; background: rgba(245,197,24,.12); border: 1px solid rgba(245,197,24,.35); color: var(--accent); font-weight: 700; font-size: 1rem; padding: 12px 28px; border-radius: 40px; margin-top: 24px; position: relative; animation: fadeUp .5s .5s ease both; }
    .ty-body { max-width: 600px; width: 100%; padding: 48px 20px 80px; animation: fadeUp .5s .4s ease both; }
    .ty-card { background: var(--white, #fff); border: 1px solid var(--border); border-radius: 16px; padding: 28px; margin-bottom: 20px; }
    .ty-card-title { font-family: 'Playfair Display', serif; font-size: 1.1rem; font-weight: 700; color: var(--dark); margin: 0 0 18px; }
    .detail-row { display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid var(--border); font-size: .9rem; }
    .detail-row:last-child { border-bottom: none; }
    .detail-label { color: var(--text-muted); }
    .detail-value { font-weight: 600; color: var(--text); }
    .detail-value.highlight { color: var(--accent); font-size: 1.05rem; }
    .steps { display: flex; flex-direction: column; gap: 16px; }
    .step { display: flex; align-items: flex-start; gap: 14px; }
    .step-num { width: 32px; height: 32px; min-width: 32px; background: var(--accent); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 800; font-size: .85rem; color: #111; }
    .step-text { font-size: .9rem; color: var(--text); line-height: 1.5; padding-top: 4px; }
    .step-text strong { color: var(--dark); }
    .action-row { display: flex; gap: 12px; flex-wrap: wrap; margin-top: 8px; }
    .btn-primary { flex: 1; padding: 14px; background: var(--accent); color: #111; border: none; border-radius: 10px; font-family: 'DM Sans', sans-serif; font-size: .95rem; font-weight: 700; cursor: pointer; text-align: center; text-decoration: none; display: inline-block; transition: opacity .2s; }
    .btn-primary:hover { opacity: .85; }
    .btn-secondary { flex: 1; padding: 14px; background: transparent; color: var(--text); border: 1.5px solid var(--border); border-radius: 10px; font-family: 'DM Sans', sans-serif; font-size: .95rem; font-weight: 600; cursor: pointer; text-align: center; text-decoration: none; display: inline-block; transition: all .2s; }
    .btn-secondary:hover { border-color: var(--dark); color: var(--dark); }
  </style>
</head>
<body>
  <header class="navbar">
    <a href="dashboard.html" class="logo">Skyline Treats</a>
    <nav class="nav-links" id="nav">
      <a href="dashboard.html">Menu</a>
      <a href="profile.html">My Orders</a>
      <a href="contactus.html">Contact</a>
      <a href="#" class="signout" id="signoutBtn">Sign Out</a>
    </nav>
    <div class="nav-right">
      <button class="theme-toggle-btn" id="themeBtn">üåô Dark</button>
      <div class="menu-toggle" id="toggle"><div class="bar"></div><div class="bar"></div><div class="bar"></div></div>
    </div>
  </header>

  <div class="ty-page">
    <div class="ty-hero">
      <div class="checkmark-circle">‚úì</div>
      <h1>Order Confirmed!</h1>
      <p>Your order has been received and payment processed. Your food is being prepared!</p>
      <div class="order-badge">
        <span>Order <span id="order-id-badge">#‚Äî</span></span>
        <span>¬∑</span>
        <span id="order-total-badge">KSH 0.00</span>
      </div>
    </div>

    <div class="ty-body">
      <div class="ty-card">
        <p class="ty-card-title">üìã Order Details</p>
        <div class="detail-row"><span class="detail-label">Order ID</span><span class="detail-value" id="detail-id">‚Äî</span></div>
        <div class="detail-row"><span class="detail-label">Payment Method</span><span class="detail-value" id="detail-method">‚Äî</span></div>
        <div class="detail-row"><span class="detail-label">Total Paid</span><span class="detail-value highlight" id="detail-total">‚Äî</span></div>
        <div class="detail-row"><span class="detail-label">Date &amp; Time</span><span class="detail-value" id="detail-date">‚Äî</span></div>
        <div class="detail-row"><span class="detail-label">Status</span><span class="detail-value" style="color:#16a34a;">‚úÖ Confirmed</span></div>
      </div>

      <div class="ty-card">
        <p class="ty-card-title">‚è±Ô∏è What happens next?</p>
        <div class="steps">
          <div class="step"><div class="step-num">1</div><div class="step-text"><strong>Order received</strong> ‚Äî our kitchen has been notified and will start preparing your food shortly.</div></div>
          <div class="step"><div class="step-num">2</div><div class="step-text"><strong>Preparation</strong> ‚Äî your food is freshly made to order. Usually takes 10‚Äì20 minutes.</div></div>
          <div class="step"><div class="step-num">3</div><div class="step-text" id="step-3-text"><strong>Ready for pickup</strong> ‚Äî we'll let you know when your order is ready at Tom Mboya Street.</div></div>
        </div>
      </div>

      <div class="action-row">
        <a href="profile.html" class="btn-secondary">üìã View My Orders</a>
        <a href="dashboard.html" class="btn-primary">üçî Order Again</a>
      </div>
    </div>
  </div>

  <script>
    const themeBtn = document.getElementById('themeBtn');
    function applyTheme(t) { document.documentElement.setAttribute('data-theme',t); localStorage.setItem('st_theme',t); themeBtn.textContent = t==='dark'?'‚òÄÔ∏è Light':'üåô Dark'; }
    applyTheme(localStorage.getItem('st_theme')||'light');
    themeBtn.addEventListener('click',()=>applyTheme(document.documentElement.getAttribute('data-theme')==='dark'?'light':'dark'));
    document.getElementById('toggle').addEventListener('click',e=>{e.stopPropagation();document.getElementById('nav').classList.toggle('active');});
    document.getElementById('signoutBtn').addEventListener('click',e=>{e.preventDefault();localStorage.removeItem('st_token');localStorage.removeItem('st_user');window.location.href='home.html';});

    const orderId = localStorage.getItem('last_order_id')    || '‚Äî';
    const total   = parseFloat(localStorage.getItem('last_order_total') || '0');
    const method  = localStorage.getItem('last_order_method') || '‚Äî';
    const now     = new Date().toLocaleString('en-KE', { dateStyle:'medium', timeStyle:'short' });

    document.getElementById('order-id-badge').textContent    = '#' + orderId;
    document.getElementById('order-total-badge').textContent = 'KSH ' + total.toFixed(2);
    document.getElementById('detail-id').textContent         = '#' + orderId;
    document.getElementById('detail-method').textContent     = method;
    document.getElementById('detail-total').textContent      = 'KSH ' + total.toFixed(2);
    document.getElementById('detail-date').textContent       = now;

    const lastHistory = JSON.parse(localStorage.getItem('ronz_order_history') || '[]');
    const lastOrder   = lastHistory[lastHistory.length - 1];
    if (lastOrder && lastOrder.delivery_type === 'delivery') {
      document.getElementById('step-3-text').innerHTML = '<strong>On the way!</strong> ‚Äî your rider will be dispatched once ready. Expected delivery in 30‚Äì45 minutes.';
    }

    setTimeout(() => {
      localStorage.removeItem('last_order_id');
      localStorage.removeItem('last_order_total');
      localStorage.removeItem('last_order_method');
    }, 5000);
  </script>
</body>
</html>